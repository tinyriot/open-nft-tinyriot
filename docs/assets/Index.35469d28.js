import{S as he,i as ye,s as ve,e as p,t as Q,a as k,c as ke,b as me,d as u,f as w,g as i,m as ge,h as se,j as we,k as Ce,l as C,n as Ne,o as Le,p as _e,q as E,r as V,u as re,v as B,w as Se,x as Te,y as Ae,z as be}from"./index.534f2e7f.js";import{N as Me}from"./Nav.6c89479b.js";import{u as qe,f as Fe}from"./factory.fc96e4e7.js";import{w as He}from"./settings.f5ab2b6d.js";function ce(n,e,t){const l=n.slice();return l[28]=e[t],l}function Ie(n){let e,t,l,s,d,_,m,a,r,b,c,y,q,f,M,U,A,Z,z,$,x,G,X,ee,F,te,P,Y,le,H,h,D,O,I,R,N,g=n[5]==="hidden"&&fe(n),S=n[7]&&n[7].length>0&&ue(n);function ne(o,v){return o[2]?Be:je}let J=ne(n),W=J(n);function ie(o,v){return o[5]==="hidden"?Ge:Ee}let oe=ie(n),j=oe(n),K=n[1],T=[];for(let o=0;o<K.length;o+=1)T[o]=de(ce(n,K,o));return{c(){g&&g.c(),e=k(),t=p("header"),l=p("form"),s=p("div"),d=p("label"),d.textContent="name",_=k(),m=p("input"),a=k(),r=p("div"),b=p("label"),b.textContent="symbol",c=k(),y=p("input"),q=k(),f=p("div"),M=p("label"),M.textContent="placeholder uri",U=k(),A=p("input"),Z=k(),z=p("div"),S&&S.c(),$=k(),W.c(),x=k(),G=p("div"),X=p("label"),X.textContent="total supply",ee=k(),F=p("input"),te=k(),P=p("div"),Y=p("label"),Y.textContent="base uri",le=k(),H=p("input"),h=k(),j.c(),O=k();for(let o=0;o<T.length;o+=1)T[o].c();I=me(),u(m,"type","text"),u(m,"placeholder","name"),u(s,"class","item"),u(y,"type","text"),u(y,"placeholder","symbol"),u(r,"class","item"),u(A,"type","text"),u(A,"placeholder","placeholder uri (optional. if not set, a default image will be used)"),u(z,"class","file-holder"),u(f,"class","item"),u(F,"type","number"),u(F,"placeholder","total supply"),u(G,"class","item"),u(H,"type","text"),u(H,"placeholder","base uri (optional. you can set it later)"),u(P,"class","item"),u(l,"class",D="form "+n[5])},m(o,v){g&&g.m(o,v),w(o,e,v),w(o,t,v),i(t,l),i(l,s),i(s,d),i(s,_),i(s,m),B(m,n[0].name),i(l,a),i(l,r),i(r,b),i(r,c),i(r,y),B(y,n[0].symbol),i(l,q),i(l,f),i(f,M),i(f,U),i(f,A),B(A,n[0].placeholder),i(f,Z),i(f,z),S&&S.m(z,null),i(f,$),W.m(f,null),i(l,x),i(l,G),i(G,X),i(G,ee),i(G,F),B(F,n[0].supply),i(l,te),i(l,P),i(P,Y),i(P,le),i(P,H),B(H,n[0].base),i(l,h),j.m(l,null),w(o,O,v);for(let L=0;L<T.length;L+=1)T[L].m(o,v);w(o,I,v),R||(N=[E(m,"input",n[18]),E(y,"input",n[19]),E(A,"input",n[20]),E(F,"input",n[22]),E(H,"input",n[23]),E(l,"submit",Se(Te(n[13])))],R=!0)},p(o,v){if(o[5]==="hidden"?g?g.p(o,v):(g=fe(o),g.c(),g.m(e.parentNode,e)):g&&(g.d(1),g=null),v&1&&m.value!==o[0].name&&B(m,o[0].name),v&1&&y.value!==o[0].symbol&&B(y,o[0].symbol),v&1&&A.value!==o[0].placeholder&&B(A,o[0].placeholder),o[7]&&o[7].length>0?S?S.p(o,v):(S=ue(o),S.c(),S.m(z,null)):S&&(S.d(1),S=null),J===(J=ne(o))&&W?W.p(o,v):(W.d(1),W=J(o),W&&(W.c(),W.m(f,null))),v&1&&_e(F.value)!==o[0].supply&&B(F,o[0].supply),v&1&&H.value!==o[0].base&&B(H,o[0].base),oe===(oe=ie(o))&&j?j.p(o,v):(j.d(1),j=oe(o),j&&(j.c(),j.m(l,null))),v&32&&D!==(D="form "+o[5])&&u(l,"class",D),v&2){K=o[1];let L;for(L=0;L<K.length;L+=1){const ae=ce(o,K,L);T[L]?T[L].p(ae,v):(T[L]=de(ae),T[L].c(),T[L].m(I.parentNode,I))}for(;L<T.length;L+=1)T[L].d(1);T.length=K.length}},d(o){g&&g.d(o),o&&C(e),o&&C(t),S&&S.d(),W.d(),j.d(),o&&C(O),Ae(T,o),o&&C(I),R=!1,be(N)}}}function We(n){let e;return{c(){e=p("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>loading...',u(e,"class","loading")},m(t,l){w(t,e,l)},p:V,d(t){t&&C(e)}}}function fe(n){let e,t,l,s;return{c(){e=p("div"),t=p("button"),t.textContent="+ create a contract",u(e,"class","top")},m(d,_){w(d,e,_),i(e,t),l||(s=E(t,"click",n[11]),l=!0)},p:V,d(d){d&&C(e),l=!1,s()}}}function ue(n){let e,t;return{c(){e=p("img"),u(e,"class","thumb"),re(e.src,t=n[7])||u(e,"src",t)},m(l,s){w(l,e,s)},p(l,s){s&128&&!re(e.src,t=l[7])&&u(e,"src",t)},d(l){l&&C(e)}}}function je(n){let e,t,l;return{c(){e=p("input"),u(e,"type","file"),u(e,"accept","image/*")},m(s,d){w(s,e,d),t||(l=[E(e,"change",n[21]),E(e,"change",n[14])],t=!0)},p:V,d(s){s&&C(e),t=!1,be(l)}}}function Be(n){let e;return{c(){e=p("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>uploading...',u(e,"class","loading")},m(t,l){w(t,e,l)},p:V,d(t){t&&C(e)}}}function Ee(n){let e,t,l,s,d;function _(r,b){return r[3]?Ve:Pe}let m=_(n),a=m(n);return{c(){e=p("div"),a.c(),t=k(),l=p("button"),l.textContent="close",u(e,"class","item")},m(r,b){w(r,e,b),a.m(e,null),i(e,t),i(e,l),s||(d=E(l,"click",n[12]),s=!0)},p(r,b){m!==(m=_(r))&&(a.d(1),a=m(r),a&&(a.c(),a.m(e,t)))},d(r){r&&C(e),a.d(),s=!1,d()}}}function Ge(n){return{c:V,m:V,p:V,d:V}}function Pe(n){let e;return{c(){e=p("input"),u(e,"type","submit"),e.value="Deploy"},m(t,l){w(t,e,l)},d(t){t&&C(e)}}}function Ve(n){let e;return{c(){e=p("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>deploying...',u(e,"class","loading")},m(t,l){w(t,e,l)},d(t){t&&C(e)}}}function pe(n){let e,t=n[28].name+"",l,s,d=n[28].symbol+"",_,m;return{c(){e=p("h2"),l=Q(t),s=Q(" ("),_=Q(d),m=Q(")")},m(a,r){w(a,e,r),i(e,l),i(e,s),i(e,_),i(e,m)},p(a,r){r&2&&t!==(t=a[28].name+"")&&se(l,t),r&2&&d!==(d=a[28].symbol+"")&&se(_,d)},d(a){a&&C(e)}}}function de(n){let e,t,l,s=n[28].address+"",d,_,m,a=n[28].name&&pe(n);return{c(){e=p("a"),a&&a.c(),t=k(),l=p("div"),d=Q(s),_=k(),u(e,"class","item"),u(e,"href",m="/contract/#"+n[28].address)},m(r,b){w(r,e,b),a&&a.m(e,null),i(e,t),i(e,l),i(l,d),i(e,_)},p(r,b){r[28].name?a?a.p(r,b):(a=pe(r),a.c(),a.m(e,t)):a&&(a.d(1),a=null),b&2&&s!==(s=r[28].address+"")&&se(d,s),b&2&&m!==(m="/contract/#"+r[28].address)&&u(e,"href",m)},d(r){r&&C(e),a&&a.d()}}}function ze(n){let e,t,l,s,d,_,m;s=new Me({props:{v1:n[16],v2:n[15],network:n[10],account:n[9]}});function a(c,y){return c[4]?We:Ie}let r=a(n),b=r(n);return{c(){e=p("div"),t=Q(n[8]),l=k(),ke(s.$$.fragment),d=k(),b.c(),_=me(),u(e,"class","error")},m(c,y){w(c,e,y),i(e,t),w(c,l,y),ge(s,c,y),w(c,d,y),b.m(c,y),w(c,_,y),m=!0},p(c,[y]){(!m||y&256)&&se(t,c[8]);const q={};y&1024&&(q.network=c[10]),y&512&&(q.account=c[9]),s.$set(q),r===(r=a(c))&&b?b.p(c,y):(b.d(1),b=r(c),b&&(b.c(),b.m(_.parentNode,_)))},i(c){m||(we(s.$$.fragment,c),m=!0)},o(c){Ce(s.$$.fragment,c),m=!1},d(c){c&&C(e),c&&C(l),Ne(s,c),c&&C(d),b.d(c),c&&C(_)}}}function De(n,e,t){let{version:l}=e,s,d,_=[],m=!1,a,r,b="hidden",c=[],y="",q="",f={name:"",symbol:"",placeholder:"",supply:"",base:""},M,U,A;const Z=async()=>{t(4,r=!0),t(9,M=await d.account);let h=await A.getPastEvents("CollectionAdded",{filter:{receiver:M},fromBlock:0,toBlock:"latest"}).then(N=>N.map(g=>g.returnValues.collection)),D=Array.from(new Set(h)),O=[];const I=new F0;for(let N of D)console.log("address",N),O.push({address:N,name:"fetching...",symbol:""});t(1,_=O),t(4,r=!1);let R=[];for(let N=0;N<_.length;N++){let g=_[N].address;if(await I.init({web3:s,contract:g}),(await I.api.owner().call()).toLowerCase()!==M.toLowerCase()){console.log("remove at",N),R.push(N);continue}else{let ne=await I.api.name().call(),J=await I.api.symbol().call();t(1,_[N].name=ne,_),t(1,_[N].symbol=J,_)}}for(let N of R)_.splice(N,1)},z=()=>{t(5,b="")},$=()=>{t(5,b="hidden")},x=async()=>{t(3,a=!0),console.log("payload",f);try{let h=await A.methods.genesis(M,f.name,f.symbol,{placeholder:f.placeholder,base:f.base,supply:f.supply,permanent:!1}).send({from:M});console.log("tx",h),t(3,a=!1),location.href="/contract/#"+h.events.CollectionAdded.returnValues.collection}catch(h){t(8,q=h.message)}},G=async()=>{if(c.length>0){t(2,m=!0);try{let h=await qe(c[0]);t(0,f.placeholder="ipfs://"+h,f)}catch{confirm("NFT.STORAGE api key needed. Go to the config page and set it first")&&window.open("/config/")}t(2,m=!1)}};let X=l==="v2"?"selected":"",ee=l==="v1"?"selected":"";Le(async()=>{try{d=new Superprovider({walletconnect:He});let h=await d.current();h||(h=await d.connect()),t(9,M=d.account),s=new Web3(h),A=await Fe(s,l),t(10,U=A.$network),await Z()}catch(h){t(8,q=h.message)}});function F(){f.name=this.value,t(0,f)}function te(){f.symbol=this.value,t(0,f)}function P(){f.placeholder=this.value,t(0,f)}function Y(){c=this.files,t(6,c)}function le(){f.supply=_e(this.value),t(0,f)}function H(){f.base=this.value,t(0,f)}return n.$$set=h=>{"version"in h&&t(17,l=h.version)},n.$$.update=()=>{n.$$.dirty&1&&f&&f.placeholder&&fetch("https://ipfs.io/ipfs/"+f.placeholder.replace("ipfs://","")).then(h=>h.json()).then(h=>{h.image.startsWith("ipfs://")?t(7,y="https://ipfs.io/ipfs/"+h.image.replace("ipfs://","")):h.image.startsWith("http")&&t(7,y=h.image)})},[f,_,m,a,r,b,c,y,q,M,U,z,$,x,G,X,ee,l,F,te,P,Y,le,H]}class Qe extends he{constructor(e){super(),ye(this,e,De,ze,ve,{version:17})}}export{Qe as I};
